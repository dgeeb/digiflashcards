import{a as S,r as M,p as f,q as B,s as L,x as D,y as O,c as n,b as t,t as r,F as x,m as N,d as m,w as E,e as y,v,u as W,o as i,k as Y,z as $}from"./index-kXFCKEwh.js";const j={key:0,class:"dashboard"},z={class:"dashboard__intro"},K={class:"dashboard__summary"},R={class:"summary-chip"},G={class:"summary-chip__value"},H={class:"summary-chip"},J={class:"summary-chip__value"},P={class:"dashboard__today"},Q={key:0,class:"empty-state"},X={key:1,class:"daily-list"},Z={class:"daily-item__actions"},tt=["onClick"],st={class:"dashboard__courses"},et={class:"dashboard__courses-header"},ot={class:"form-grid"},rt={class:"form-field"},lt={class:"form-field"},nt={key:0,class:"form-error",role:"alert"},it={class:"course-grid"},at={class:"course-card__header"},dt={class:"course-card__points"},ut={class:"course-card__description"},pt={class:"course-card__stats"},ct={class:"course-card__footer"},mt=["onClick"],yt={key:1,class:"dashboard dashboard--empty"},vt={class:"empty-card"},_t={class:"form-field"},ft={class:"form-field"},bt={key:0,class:"form-error",role:"alert"},Ct={__name:"Dashboard",emits:["notify"],setup(ht,{emit:F}){const I=F,b=W(),{updateCurrentUser:T}=Y(),a=S(!1),d=S(""),l=M({title:"",description:""}),_=f(()=>{var o,s;return(s=(o=B.value)==null?void 0:o.courses)!=null?s:[]}),u=f(()=>L(_.value)),h=f(()=>_.value.map(o=>{var w;let s=0,e=0,p=0,k=0;return o.stages.forEach(q=>{const c=D(q);s+=c.due,e+=c.newCards,p+=c.mastered,k+=c.total}),{id:o.id,title:o.title,description:o.description,points:(w=o.points)!=null?w:0,stageCount:o.stages.length,due:s,newCards:e,mastered:p,totalCards:k}}));O(()=>{_.value.forEach(o=>{o.stages.forEach(s=>D(s))})});function g(){a.value=!a.value}function U(){l.title="",l.description="",d.value=""}function C(){if(!l.title.trim()){d.value="A course title is required.";return}T(o=>{o.courses.push({id:$(),title:l.title.trim(),description:l.description.trim(),createdAt:new Date().toISOString(),points:0,stages:[]})}),I("notify","New course created! Add a stage to begin."),U(),a.value=!1}function V(o){b.push({name:"StageSession",params:{courseId:o.courseId,stageId:o.stageId}})}function A(o){b.push({name:"CourseDetail",params:{courseId:o}})}return(o,s)=>h.value.length?(i(),n("section",j,[t("header",z,[s[6]||(s[6]=t("div",null,[t("h1",null,"Today's session"),t("p",null,"Keep your momentum! Your personalised spaced repetition plan is ready.")],-1)),t("div",K,[t("div",R,[s[4]||(s[4]=t("span",{class:"summary-chip__label"},"Due reviews",-1)),t("span",G,r(u.value.totalDue),1)]),t("div",H,[s[5]||(s[5]=t("span",{class:"summary-chip__label"},"New cards",-1)),t("span",J,r(u.value.totalNew),1)])])]),t("section",P,[s[7]||(s[7]=t("h2",null,"Focus for the day",-1)),u.value.perStage.length?(i(),n("ul",X,[(i(!0),n(x,null,N(u.value.perStage,e=>(i(),n("li",{key:e.stageId,class:"daily-item"},[t("div",null,[t("h3",null,r(e.courseTitle)+" — "+r(e.stageTitle),1),t("p",null,r(e.due)+" review"+r(e.due===1?"":"s")+" · "+r(e.fresh)+" new card"+r(e.fresh===1?"":"s"),1)]),t("div",Z,[t("button",{class:"button button--ghost",type:"button",onClick:p=>V(e)},"Start session",8,tt)])]))),128))])):(i(),n("p",Q,"Everything is up to date. Why not add more cards?"))]),t("section",st,[t("header",et,[s[8]||(s[8]=t("div",null,[t("h2",null,"Your courses"),t("p",null,"Create stages and cards to shape your learning journey.")],-1)),t("button",{class:"button button--primary",type:"button",onClick:g},r(a.value?"Close":"New course"),1)]),a.value?(i(),n("form",{key:0,class:"inline-form",onSubmit:E(C,["prevent"])},[t("div",ot,[t("div",rt,[s[9]||(s[9]=t("label",{for:"course-title"},"Title",-1)),y(t("input",{id:"course-title","onUpdate:modelValue":s[0]||(s[0]=e=>l.title=e),type:"text",required:""},null,512),[[v,l.title]])]),t("div",lt,[s[10]||(s[10]=t("label",{for:"course-description"},"Description",-1)),y(t("input",{id:"course-description","onUpdate:modelValue":s[1]||(s[1]=e=>l.description=e),type:"text",placeholder:"What will you master?"},null,512),[[v,l.description]])])]),d.value?(i(),n("p",nt,r(d.value),1)):m("",!0),s[11]||(s[11]=t("button",{class:"button button--success",type:"submit"},"Create course",-1))],32)):m("",!0),t("div",it,[(i(!0),n(x,null,N(h.value,e=>(i(),n("article",{key:e.id,class:"course-card"},[t("header",at,[t("h3",null,r(e.title),1),t("span",dt,r(e.points)+" pts",1)]),t("p",ut,r(e.description||"No description yet."),1),t("dl",pt,[t("div",null,[s[12]||(s[12]=t("dt",null,"Stages",-1)),t("dd",null,r(e.stageCount),1)]),t("div",null,[s[13]||(s[13]=t("dt",null,"Cards",-1)),t("dd",null,r(e.totalCards),1)]),t("div",null,[s[14]||(s[14]=t("dt",null,"Due",-1)),t("dd",null,r(e.due),1)]),t("div",null,[s[15]||(s[15]=t("dt",null,"New",-1)),t("dd",null,r(e.newCards),1)]),t("div",null,[s[16]||(s[16]=t("dt",null,"Mastered",-1)),t("dd",null,r(e.mastered),1)])]),t("footer",ct,[t("button",{class:"button button--ghost",type:"button",onClick:p=>A(e.id)},"Open course",8,mt)])]))),128))])])])):(i(),n("section",yt,[t("div",vt,[s[20]||(s[20]=t("h1",null,"Let's build your first course",-1)),s[21]||(s[21]=t("p",null,"Create stages to organise your content and add cards to feed the spaced repetition engine.",-1)),t("button",{class:"button button--primary",type:"button",onClick:g},"Create a course"),a.value?(i(),n("form",{key:0,class:"inline-form inline-form--center",onSubmit:E(C,["prevent"])},[t("div",_t,[s[17]||(s[17]=t("label",{for:"course-title-empty"},"Title",-1)),y(t("input",{id:"course-title-empty","onUpdate:modelValue":s[2]||(s[2]=e=>l.title=e),type:"text",required:""},null,512),[[v,l.title]])]),t("div",ft,[s[18]||(s[18]=t("label",{for:"course-description-empty"},"Description",-1)),y(t("input",{id:"course-description-empty","onUpdate:modelValue":s[3]||(s[3]=e=>l.description=e),type:"text"},null,512),[[v,l.description]])]),d.value?(i(),n("p",bt,r(d.value),1)):m("",!0),s[19]||(s[19]=t("button",{class:"button button--success",type:"submit"},"Create course",-1))],32)):m("",!0)])]))}};export{Ct as default};
