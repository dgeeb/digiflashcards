import{a as d,r as x,c as r,b as t,w as N,d as p,e as f,v as c,t as m,F as y,j as w,f as S,g as B,h as F,u as P,o as n,k as U}from"./index-kXFCKEwh.js";const A={class:"auth-page"},C={class:"auth-card"},L={class:"form-field"},R=["disabled"],D={key:0,class:"form-field"},E={for:"forgot-answer"},M={key:1,class:"form-field"},T={key:2,class:"form-error",role:"alert"},j=["disabled"],Q={class:"auth-card__links"},G={__name:"ForgotPassword",emits:["notify"],setup(W,{emit:g}){const v=g,b=P(),{getSecretQuestion:h,resetPassword:k}=U(),o=d(1),_=d(""),a=d(!1),i=d(""),s=x({email:"",answer:"",password:""});async function q(){if(!a.value){i.value="",a.value=!0;try{o.value===1?(_.value=h(s.email),o.value=2,v("notify","We found your question. Answer it to continue.")):(await k(s.email,s.answer,s.password),v("notify","Password updated. See you soon!"),b.push({name:"Login"}))}catch(u){i.value=(u==null?void 0:u.message)||"Something went wrong. Please try again."}finally{a.value=!1}}}return(u,e)=>{const V=F("router-link");return n(),r("section",A,[t("article",C,[e[6]||(e[6]=t("header",{class:"auth-card__header"},[t("h1",null,"Reset your password"),t("p",null,"Answer your secret question to create a new password.")],-1)),t("form",{class:"auth-card__form",onSubmit:N(q,["prevent"])},[t("div",L,[e[3]||(e[3]=t("label",{for:"forgot-email"},"Email",-1)),f(t("input",{id:"forgot-email","onUpdate:modelValue":e[0]||(e[0]=l=>s.email=l),type:"email",autocomplete:"email",required:"",disabled:o.value===2},null,8,R),[[c,s.email]])]),o.value===2?(n(),r("div",D,[t("label",E,m(_.value),1),f(t("input",{id:"forgot-answer","onUpdate:modelValue":e[1]||(e[1]=l=>s.answer=l),type:"text",required:""},null,512),[[c,s.answer]])])):p("",!0),o.value===2?(n(),r("div",M,[e[4]||(e[4]=t("label",{for:"forgot-new"},"New password",-1)),f(t("input",{id:"forgot-new","onUpdate:modelValue":e[2]||(e[2]=l=>s.password=l),type:"password",autocomplete:"new-password",required:""},null,512),[[c,s.password]])])):p("",!0),i.value?(n(),r("p",T,m(i.value),1)):p("",!0),t("button",{class:"button button--primary",type:"submit",disabled:a.value},[o.value===1?(n(),r(y,{key:0},[w(m(a.value?"Looking up…":"Find my question"),1)],64)):(n(),r(y,{key:1},[w(m(a.value?"Updating…":"Reset password"),1)],64))],8,j)],32),t("div",Q,[S(V,{to:{name:"Login"}},{default:B(()=>[...e[5]||(e[5]=[w("Back to login",-1)])]),_:1})])])])}}};export{G as default};
